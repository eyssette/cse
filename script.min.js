const searchEngine="https://zotop.zaclys.com/search?q=",disabledEngines="&disabled_engines=brave",defineLang="&language=all",cseDefault="# Créez votre moteur de recherche\n\n> Ce site vous permet de créer un moteur de recherche personnalisé à partir d'une liste de sites.\n> 1. Créez un fichier sur CodiMD ou sur une forge.\n> 2. Ce fichier doit comporter : un titre, un bloc de citation qui constituera le message initial, et une liste de sites. Vous pouvez récupérer [ce modèle](https://codimd.apps.education.fr/b8KAltV2QQWR2rKhF_eYcg?both) ou bien regarder cet [exemple](https://eyssette.forge.aeif.fr/cse#https://eyssette.forge.aeif.fr/my-cse/intro-philo.md).\n> 3. Votre moteur de recherche sera alors disponible à l'adresse : https://eyssette.forge.aeif.fr/cse#URL (en remplaçant URL par l'URL de votre fichier).\n> 4. Si votre fichier n'est pas accessible : essayez de mettre `https://api.allorigins.win/raw?url=` avant votre URL\n\n- eyssette.github.io";let md=cseDefault;const shortcuts=[["intro-philo","https://raw.githubusercontent.com/eyssette/my-cse/main/intro-philo.md"],["recherche-philo","https://raw.githubusercontent.com/eyssette/my-cse/main/recherche-philo.md"]];let cseSyntax="";function getMarkdownContent(){let e=window.location.hash.substring(1);""!==e?(e.startsWith("https://github.com")&&(e=(e=e.replace("https://github.com","https://raw.githubusercontent.com")).replace("/blob/","/")),e.startsWith("https://codimd")&&-1===e.indexOf("download")&&(e=e.replace("?edit","").replace("?both","").replace("?view","")+"/download"),shortcut=shortcuts.find(t=>t[0]==e),shortcut&&(e=shortcut[1]),fetch(e).then(e=>e.text()).then(e=>{md=e,cseData=parseMarkdown(md),createCSE(cseData)}).catch(e=>{cseData=parseMarkdown(cseDefault),createCSE(cseData),alert("Il y a une erreur dans l'URL. Merci de la vérifier et de vous assurer que le fichier est bien accessible."),console.log(e)})):(cseData=parseMarkdown(md),createCSE(cseData))}function parseMarkdown(e){const t=e.split("\n");let s=[],n="Mon moteur de recherche personnalisé",i=!1,r=[],a=[];const o=/^- +(.+)/,c=new showdown.Converter({emoji:!0,parseImgDimensions:!0,simplifiedAutoLink:!0});for(let e of t)if(e.startsWith("# "))n=e.replace("# ","").trim();else if(e.startsWith(">")&&!i)e=e.replace(/^>\s?/,"").trim(),r.push(e);else{const t=e.match(o);if(t){i=!0;const e=t[1];a.push(e)}}var l;return 0==r.length&&(r=["Vous pouvez faire votre recherche ci-dessous"]),s=[n,(l=r.join("\n"),c.makeHtml(l)),a]}getMarkdownContent();const userInput=document.getElementById("search-input"),sendButton=document.getElementById("send-button"),waitMessageElement=document.getElementById("wait-message"),loaderElement=document.getElementById("loader");function createCSE(e){const t=document.getElementById("cse-title"),s=document.getElementById("initial-message"),n=document.getElementById("search"),i=document.getElementById("credits");title=e[0],initialMessage=e[1],websites=e[2],t.innerHTML=title,s.innerHTML=initialMessage,cseSyntax=" (site:"+e[2].join(" OR site:")+")",n.style.visibility="visible",i.style.visibility="visible"}function search(e){loaderElement.style.display="block",waitMessageElement.style.visibility="visible",searchText=encodeURI(e)+" "+cseSyntax+defineLang+disabledEngines;const t=searchEngine+searchText;localStorage.setItem("searchLaunched","true"),window.location.href=t}sendButton.addEventListener("click",()=>{search(userInput.value)}),userInput.addEventListener("keypress",e=>{"Enter"===e.key&&sendButton.click()}),window.addEventListener("pageshow",()=>{loaderElement.style.display="none",waitMessageElement.style.visibility="hidden"});